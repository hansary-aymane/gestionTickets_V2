{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet CinemaComponent = class CinemaComponent {\n  constructor(cinemaservice) {\n    this.cinemaservice = cinemaservice;\n  }\n  ngOnInit() {\n    console.log(\"###############ngoninit\");\n    this.cinemaservice.getVilles().subscribe(data => {\n      this.villes = data;\n    }, error => {\n      console.log(error);\n    });\n  }\n  // @ts-ignore\n  OnGetCinema(v) {\n    this.currentVille = v;\n    this.salles = undefined;\n    this.cinemaservice.getCinemas(v).subscribe(data => {\n      this.cinemas = data;\n    }, err => {\n      console.log(err);\n    });\n  }\n  // @ts-ignore\n  OnGetSalles(c) {\n    this.currentCinema = c;\n    this.cinemaservice.getSalles(c).subscribe(data => {\n      this.salles = data;\n      // @ts-ignore\n      this.salles._embedded.salles.forEach(salle => {\n        this.cinemaservice.getProjections(salle).subscribe(data => {\n          salle.projections = data;\n        }, err => {\n          console.log(err);\n        });\n      });\n    }, err => {\n      console.log(err);\n    });\n  }\n  // @ts-ignore\n  OnGetTicketPlace(p) {\n    this.currentProjection = p;\n    this.cinemaservice.getTicketsPlaces(p).subscribe(data => {\n      this.currentProjection.tickets = data;\n      this.selectedTickets = [];\n    }, err => {\n      console.log(err);\n    });\n  }\n  // @ts-ignore\n  onSelectTicket(t) {\n    if (!t.selected) {\n      t.selected = true;\n      this.selectedTickets.push(t);\n    } else {\n      t.selected = false;\n      this.selectedTickets.splice(this.selectedTickets.indexOf(t), 1);\n    }\n  }\n  // @ts-ignore\n  getTicketClass(t) {\n    let str = \"btn ticket \";\n    if (t.reservee) {\n      str += \"btn-danger\";\n    } else if (t.selected) {\n      str += \"btn-warning\";\n    } else {\n      str += \"btn-success\";\n    }\n    return str;\n  }\n  /*\n  // @ts-ignore\n     onSelectTicket(t){\n    console.log(JSON.stringify(t.selected)+\" OnselectTicket\");\n    if(!t.selected){\n      t.selected=true;\n      this.selectedTickets.push(t);\n    }\n    t.selected=false;\n    this.selectedTickets.splice(this.selectedTickets.indexOf(t),1);\n  }\n     // @ts-ignore\n     getTicketClass(t) {\n    let str=\"btn \";\n    if(t.reserve==true){\n      str+=\"btn-danger\";\n    }\n    else if(t.selected){\n      str+=\"btn-warning\"\n    }\n    else{\n      str+=\"btn-success\"\n    }\n    return str;\n  }\n  */\n  // @ts-ignore\n  OnPayTicket(formulaire) {\n    // @ts-ignore\n    let ticket = [];\n    // @ts-ignore\n    this.selectedTickets.forEach(s => {\n      ticket.push(s.id);\n    });\n    // @ts-ignore\n    formulaire.tickets = ticket;\n    this.cinemaservice.payerTickets(formulaire).subscribe(data => {\n      alert(\"votre reservation a reussi\");\n      this.OnGetTicketPlace(this.currentProjection); // recharger la projection courante apres mod\n    }, err => {\n      console.log(err);\n    });\n  }\n};\nCinemaComponent = __decorate([Component({\n  selector: 'app-cinema',\n  templateUrl: './cinema.component.html',\n  styleUrls: ['./cinema.component.css']\n})], CinemaComponent);\nexport { CinemaComponent };","map":{"version":3,"names":["Component","CinemaComponent","constructor","cinemaservice","ngOnInit","console","log","getVilles","subscribe","data","villes","error","OnGetCinema","v","currentVille","salles","undefined","getCinemas","cinemas","err","OnGetSalles","c","currentCinema","getSalles","_embedded","forEach","salle","getProjections","projections","OnGetTicketPlace","p","currentProjection","getTicketsPlaces","tickets","selectedTickets","onSelectTicket","t","selected","push","splice","indexOf","getTicketClass","str","reservee","OnPayTicket","formulaire","ticket","s","id","payerTickets","alert","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\ayman\\OneDrive\\Bureau\\JEE Project\\gestionTickets_V2\\FrontEnd\\src\\app\\cinema\\cinema.component.ts"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\r\nimport {HttpClient} from \"@angular/common/http\";\r\nimport {CinemaService} from \"../services/cinema.service\";\r\n\r\n@Component({\r\n  selector: 'app-cinema',\r\n  templateUrl: './cinema.component.html',\r\n  styleUrls: ['./cinema.component.css']\r\n})\r\nexport class CinemaComponent implements OnInit{\r\n  // @ts-ignore\r\n  public villes;\r\n\r\n  // @ts-ignore\r\n  public cinemas;\r\n  // @ts-ignore\r\n  public salles;\r\n\r\n  // @ts-ignore\r\n  public currentVille;\r\n\r\n  // @ts-ignore\r\n  public currentCinema;\r\n  // @ts-ignore\r\n  public currentProjection;\r\n  // @ts-ignore\r\n  private ticket;\r\n\r\n  // @ts-ignore\r\n  public selectedTickets;\r\n  constructor(public cinemaservice:CinemaService) {\r\n  }\r\n  ngOnInit(): void {\r\n    console.log(\"###############ngoninit\")\r\n    this.cinemaservice.getVilles()\r\n      .subscribe(data=>{\r\n        this.villes=data;\r\n      },error => {\r\n        console.log(error);\r\n      })\r\n  }\r\n\r\n  // @ts-ignore\r\n  OnGetCinema(v): void {\r\n    this.currentVille=v;\r\n    this.salles=undefined;\r\n    this.cinemaservice.getCinemas(v)\r\n      .subscribe(data=>{\r\n        this.cinemas=data;\r\n      },err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n  // @ts-ignore\r\n  OnGetSalles(c): void {\r\n    this.currentCinema=c;\r\n    this.cinemaservice.getSalles(c)\r\n      .subscribe(data=>{\r\n        this.salles=data;\r\n        // @ts-ignore\r\n        this.salles._embedded.salles.forEach(salle=>{\r\n          this.cinemaservice.getProjections(salle)\r\n            .subscribe(data=>{\r\n              salle.projections=data;\r\n            },err => {\r\n              console.log(err);\r\n            })\r\n        })\r\n      },err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n\r\n  // @ts-ignore\r\n  OnGetTicketPlace(p) {\r\n    this.currentProjection=p;\r\n    this.cinemaservice.getTicketsPlaces(p)\r\n      .subscribe(data=>{\r\n        this.currentProjection.tickets=data;\r\n        this.selectedTickets=[];\r\n      },err => {\r\n        console.log(err);\r\n      })\r\n\r\n  }\r\n  // @ts-ignore\r\n  onSelectTicket(t){\r\n    if(!t.selected){\r\n      t.selected = true;\r\n      this.selectedTickets.push(t);\r\n    }\r\n    else{\r\n      t.selected = false;\r\n      this.selectedTickets.splice(this.selectedTickets.indexOf(t), 1);\r\n    }\r\n  }\r\n  // @ts-ignore\r\n  getTicketClass(t){\r\n    let str=\"btn ticket \";\r\n    if(t.reservee){\r\n      str += \"btn-danger\";\r\n    }\r\n    else if(t.selected){\r\n      str += \"btn-warning\";\r\n    }else{\r\n      str += \"btn-success\";\r\n    }\r\n    return str;\r\n  }\r\n  /*\r\n  // @ts-ignore\r\n\r\n  onSelectTicket(t){\r\n    console.log(JSON.stringify(t.selected)+\" OnselectTicket\");\r\n    if(!t.selected){\r\n      t.selected=true;\r\n      this.selectedTickets.push(t);\r\n    }\r\n    t.selected=false;\r\n    this.selectedTickets.splice(this.selectedTickets.indexOf(t),1);\r\n  }\r\n\r\n  // @ts-ignore\r\n\r\n  getTicketClass(t) {\r\n    let str=\"btn \";\r\n    if(t.reserve==true){\r\n      str+=\"btn-danger\";\r\n    }\r\n    else if(t.selected){\r\n      str+=\"btn-warning\"\r\n    }\r\n    else{\r\n      str+=\"btn-success\"\r\n    }\r\n    return str;\r\n  }\r\n*/\r\n  // @ts-ignore\r\n  OnPayTicket(formulaire) {\r\n    // @ts-ignore\r\n    let ticket=[];\r\n    // @ts-ignore\r\n    this.selectedTickets.forEach(s=>{\r\n      ticket.push(s.id)\r\n    })\r\n    // @ts-ignore\r\n    formulaire.tickets=ticket;\r\n    this.cinemaservice.payerTickets(formulaire)\r\n      .subscribe(data=>{\r\n        alert(\"votre reservation a reussi\")\r\n        this.OnGetTicketPlace(this.currentProjection); // recharger la projection courante apres mod\r\n      },err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}